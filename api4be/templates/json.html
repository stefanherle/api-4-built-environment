{% extends "base.html" %}

{% block title %}
{{title}}
{% endblock %}

{% block styles %}
{{super()}}
{% endblock %}

{% block formats %}
<ul class="navbar-nav">
    <li class="nav-item active">
        <a class="nav-link" href="">HTML <span class="sr-only">(current)</span></a>
    </li>
    {% for format in formats: %}
    <li class="nav-item">
        <a class="nav-link" href="?format={{format[1]}}">{{format[0]}}</a>
    </li>
    {%endfor%}
</ul>
{% endblock %}

{% block dataview %}

{% endblock %}


{% block view %}
<div id="map" class="map"></div>
{% endblock %}

{% block scripts %}
{{super()}}
<script type="text/javascript">

    //data
    async function fetchDataAsJson(name, url) {
      const response = await fetch(url);
      const data = await response.json();
      initJsonTable(name, data);
    }

    let name = {{name | tojson}}
    let url = {{url | tojson}}
    if (Array.isArray(url)) {
        for (u in url) {
            let n = "Dataset " + (u+1);
            if (Array.isArray(name) && name[u] != undefined) {
                n = name[u]
            }
            fetchDataAsJson(n, url[u]);
        }
    } else {
        fetchDataAsJson(name, url);
    }
  </script>
{% endblock %}